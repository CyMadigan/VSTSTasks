{
  "id": "F5D9D12E-338A-4B5D-B815-7BD8AC5CE7B2",
  "name": "DacPacBuildCompare",
  "friendlyName": "DacPac Build Compare",
  "description": "Provides a report on database model changes when compared to the last build for the specified branch",
  "author": "Kerwin Carpede",
  "helpMarkDown": "",
  "category": "Build",
  "visibility": [
    "Build",
    "Release"
  ],
  "demands": [
    "sqlpackage"
  ],
  "version": {
    "Major": "0",
    "Minor": "1",
    "Patch": "1"
  },
  "minimumAgentVersion": "1.91.0",
  "instanceNameFormat": "DacPac Build Compare $(dacpacName).dacpac",
  "groups": [
    {
      "name": "advanced",
      "displayName": "Advanced",
      "isExpanded": false
    }
  ],
  "inputs": [
    {
      "name": "sourceBranchName",
      "type": "string",
      "label": "Source Branch Name",
      "defaultValue": "ref/head/master",
      "required": true,
      "helpMarkDown": "Specify the branch to compare to" 
    },
    {
      "name": "dacpacFilePath",
      "type": "string",
      "label": "Dacpac File Path",
      "defaultValue": "drop",
      "required": true,
      "helpMarkDown": "Specify the dacpac path" 
    },
    {
      "name": "dacpacName",
      "type": "string",
      "label": "DacPac Name",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Name of the dacpac (without .dacpac extension) to run the schema compare on."
    },
    {
      "name": "targetDacPacPath",
      "type": "filePath",
      "label": "Compiled DacPac Path",
      "defaultValue": "",
      "required": true,
      "helpMarkDown": "Path to find the target dacpac (typically the artifact staging path where the dacpac will be uploaded from)."
    },
    {
      "name": "extraArgs",
      "type": "string",
      "label": "Extra SQLPackage args",
      "defaultValue": "",
      "required": false,
      "helpMarkDown": "Extra args to use for running the SQLPackage.exe schema compare command.",
      "groupName": "advanced"
    }
  ],
  "execution": {
    "PowerShell3": {
      "target": "GenerateDacpacBuildReport.ps1"
    }
  }
}
